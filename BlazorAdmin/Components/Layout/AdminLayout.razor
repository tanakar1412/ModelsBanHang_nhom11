@inherits LayoutComponentBase
@inject NavigationManager NavigationManager

<link href="css/Sidebar.css" rel="stylesheet" />

<div class="page">
    <div class="sidebar">
        <NavAdmin />
    </div>

    <div class="main">
        <div class="header">
            <div class="user-area">
                <span class="bell" @onclick="ToggleBellDropdown">
                    🔔<span class="badge">2</span>
                    @if (showBellDropdown)
                    {
                        <div class="dropdown-bell">
                            <div class="bell-title">Thông báo mới</div>
                            <hr>
                            <div class="dropdown-item">Thông báo 1</div>
                            <div class="dropdown-item">Thông báo 2</div>
                        </div>
                    }
                </span>

                <img class="avatar" @onclick="ToggleAvatarDropdown" src="https://randomuser.me/api/portraits/women/44.jpg" alt="user" />

                @if (showAvatarDropdown)
                {
                    <div class="dropdown-avatar">
                        <div class="dropdown-item" @onclick="GotoProfile">Thông tin tài khoản</div>
                        <div class="dropdown-item">Đăng xuất</div>
                    </div>
                }
            </div>
        </div>

        <div class="dashboard-content">
            @Body
        </div>
    </div>
</div>

@code {
    private bool showBellDropdown = false;
    private bool showAvatarDropdown = false;

    // 🔁 Tạm thời hardcode ID người dùng (có thể lấy từ login/session)
    private Guid LoggedInUserId = Guid.Parse("8a3c1a42-b3d4-49dc-bb53-d99d7b1145aa");

    private void ToggleBellDropdown()
    {
        showBellDropdown = !showBellDropdown;
        if (showBellDropdown) showAvatarDropdown = false;
    }

    private void ToggleAvatarDropdown()
    {
        showAvatarDropdown = !showAvatarDropdown;
        if (showAvatarDropdown) showBellDropdown = false;
    }

    private void GotoProfile()
    {
        showAvatarDropdown = false;
        NavigationManager.NavigateTo($"/taikhoan/chitiet/{LoggedInUserId}");
    }
}
